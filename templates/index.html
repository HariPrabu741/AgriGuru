<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>🌾AgriGuru</title>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="static/assets/favicon.ico" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
        <!-- Simple line icons-->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.5.5/css/simple-line-icons.min.css" rel="stylesheet" />
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="static/css/styles.css" rel="stylesheet" />
    </head>
    <body id="page-top">
        <!-- Navigation-->
        <a class="menu-toggle rounded" href="#"><i class="fas fa-bars"></i></a>
        <nav id="sidebar-wrapper">
            <ul class="sidebar-nav">
                <li class="sidebar-brand"><a href="#page-top">Agents of AI 🤖</a></li>
                <li class="sidebar-nav-item"><a href="#home">Home</a></li>
                <li class="sidebar-nav-item"><a href="#about">About</a></li>
                <li class="sidebar-nav-item"><a href="#services">Services</a></li>
                <li class="sidebar-nav-item"><a href="#contacts">Contact</a></li>
            </ul>
        </nav>
        <!-- Header-->
        <header class="masthead d-flex align-items-center" id="home">
            <div class="container px-4 px-lg-5 text-center">
                <h1 class="mb-2">🌾AgriGuru: Intelligent Agricultural Advisory System</h1>
                <h3 class="mb-4"><em>A Product by Agents of AI</em></h3>
                <a class="btn btn-primary btn-xl" href="#about">Find Out More</a>
            </div>
        </header>
        <!-- About-->
        <section class="content-section bg-light" id="about">
            <div class="container px-4 px-lg-5 text-center">
                <div class="row gx-4 gx-lg-5 justify-content-center">
                    <div class="col-lg-10 text-center">
                        <h2 class="fw-bold display-6 mb-4">🤖 Agents of AI Present: <span class="text-dark">AgriGuru</span></h2><br>
                        
                        <p class="fs-5 text-muted mb-5 px-3">
                            <strong>AgriGuru</strong> is an intelligent agricultural advisory platform built to empower farmers with cutting-edge AI-driven insights.
                            Whether you're a small-scale grower or a large farm operator, AgriGuru delivers the right guidance at the right time —
                            tailored to your farm’s needs.
                        </p>
                    
                        <div class="text-start mx-auto" style="max-width: 750px;">
                            <ul class="fs-5" style="list-style: none; padding-left: 0;">
                                <li class="text-muted mb-3 px-3" style="font-size: 1.20rem;">🌾 <strong>Personalized Crop Recommendations:</strong> Smart suggestions based on your soil type, location, and weather conditions.</li>
                                <li class="text-muted mb-3 px-3" style="font-size: 1.20rem;">🌦️ <strong>Weather-Integrated Guidance:</strong> Real-time climate-aware advice for irrigation, fertilizer use, and pest control.</li>
                                <li class="text-muted mb-3 px-3" style="font-size: 1.20rem;">🧪 <strong>Soil-Based Advisory:</strong> Analyze soil pH, texture, and nutrients to support sustainable practices.</li>
                                <li class="text-muted mb-3 px-3" style="font-size: 1.20rem;">📍 <strong>Location-Aware Decisions:</strong> Use our map to select your farm location for hyper-local insights.</li>
                                <li class="text-muted mb-3 px-3" style="font-size: 1.20rem;">📊 <strong>AI-Powered Yield Optimization:</strong> Boost productivity through AI tips on sowing time, fertilizer, and crop rotation.</li>
                                <li class="text-muted mb-3 px-3" style="font-size: 1.20rem;">🗣️ <strong>Multilingual Support:</strong> Available in 🌐 English, 🇮🇳 Hindi, and 🇮🇳 Malayalam for easy access to all farmers.</li>
                            </ul>
                    
                            <div class="text-start mx-auto" style="max-width: 750px;">
                                <ul class="fs-5" style="list-style: none; padding-left: 0;">
                                    <br>
                                <li class="text-muted mb-1 px-3" style="font-size: 1.05rem;">🧑‍🌾 <strong>Built for farmers.</strong></li>
                                <li class="text-muted mb-1 px-3" style="font-size: 1.05rem;">🧬 <strong>Powered by AI.</strong></li>
                                <li class="text-muted mb-1 px-3" style="font-size: 1.05rem;">🌱 <strong>Rooted in sustainability.</strong></li>
                                </ul>  
                            </div>
                        </div>
                    </div>
                    
                    
                </div>
            </div>
        </section>
        <!-- Services-->
        <section class="content-section bg-primary text-white text-center" id="services">
            <div class="container px-4 px-lg-5">
              <div class="content-section-heading">
                <h2 class="text-dark fw-bold display-6 mb-4">Select Location & Details</h2>
                <br>
              </div>
          
              <div class="card shadow-sm">
                <div class="card-body p-3 text-dark">
                  <!--<h3 class="text-center mb-3">Select Location & Details</h3>-->
          
                  <!-- Map Block -->
                  <div class="mb-4">
                    <div id="map" style="height: 400px; border-radius: 10px;"></div>

                    <div class="container px-4 px-lg-5"><br>                     
                          <div class="alert alert-info p-3"> 
                              <strong>📍 Latitude:</strong> <span id="lat">--</span><br>
                              <strong>📍 Longitude:</strong> <span id="lon">--</span>
                          </div>      
                  </div>
                                       
                  </div>
          
                  <!-- Manual Inputs -->
                  <div class="container px-4 px-lg-5">
                    <div class="alert alert-info p-3"> 

                      <form method="POST" action="/submit">
                        
                        <div class="mb-3 text-center">
                          <label for="city" class="form-label"><strong>Location</strong></label>
                          <input type="text" class="form-control py-1" id="city" name="location" placeholder="Enter city/village/state">
                        </div>
                      
                        <div class="mb-3">
                          <label for="cropInput" class="form-label"><strong>Crop (Optional)</strong></label>
                          <input type="text" class="form-control py-1" id="cropInput" name="crop" placeholder="e.g. Rice, Maize...">
                        </div>
                      
                        <div class="mb-3">
                          <label for="notes" class="form-label"><strong>Soil Condition (Required)</strong></label>
                          <textarea class="form-control py-1" id="notes" name="notes" rows="3" placeholder="e.g. soil texture, slope..." required></textarea>
                        </div>
                      
                        <div class="text-center">
                          <button type="submit" class="btn btn-primary px-4">Submit</button>
                        </div> 
                      </form>
                    </div>
                  </div>
                  
                </div>
              </div>
            </div>
          </section>
          
        
        
        <!-- Footer-->
        <footer class="footer text-center">
            <div class="container px-4 px-lg-5" id="contacts">
                <h2 class="mb-2">📱Contact Us</h2><br><br>
                <ul class="list-inline mb-5">
                    <li class="list-inline-item text-center">
                      <img src="static/assets/img/Saumya.jpeg" class="rounded-circle mb-2" width="80" height="80" alt="Saumya">
                      <div><strong>Saumya Mohandas N</strong></div>
                      <div>Senior Analyst - Data Science</div>
                      <a class="social-link rounded-circle text-white mt-1" href="https://www.linkedin.com/in/saumya-mohandas-n-97169693/" target="_blank" style="background-color: #0077b5; display: inline-block; width: 36px; height: 36px; line-height: 36px;">
                        <i class="icon-social-linkedin"></i>
                      </a>
                    </li>
                    <li class="list-inline-item text-center">
                        <img src="static/assets/img/Hari.jpeg" class="rounded-circle mb-2" width="80" height="80" alt="Hari">
                        <div><strong>Hari Prabu S</strong></div>
                        <div>Senior Analyst - Analytics Technology</div>
                        <a class="social-link rounded-circle text-white mt-1" href="https://www.linkedin.com/in/hariprabu741/" target="_blank" style="background-color: #0077b5; display: inline-block; width: 36px; height: 36px; line-height: 36px;">
                          <i class="icon-social-linkedin"></i>
                        </a>
                      </li>
                  </ul>
                  
                <p class="text-muted small mb-0">Copyright &copy; Agents of AI</p>
            </div>
        </footer>
        <!-- Scroll to Top Button-->
        <a class="scroll-to-top rounded" href="#page-top"><i class="fas fa-angle-up"></i></a>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="static/js/scripts.js"></script>
        <!-- Leaflet JS/CSS and Custom Script -->
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
const map = L.map('map').setView([20.5937, 78.9629], 5);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© OpenStreetMap contributors'
}).addTo(map);

let marker;

map.on('click', function (e) {
    const lat = e.latlng.lat.toFixed(4);
    const lon = e.latlng.lng.toFixed(4);

    if (marker) map.removeLayer(marker);
    marker = L.marker(e.latlng).addTo(map);

    document.getElementById('lat').innerText = lat;
    document.getElementById('lon').innerText = lon;

    fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`)
        .then(res => res.json())
        .then(data => {
            const addr = data.address;
            const city = addr.city || addr.town || addr.village || addr.hamlet || "Unknown";
            document.getElementById('city').innerText = city;

            // ✅ Automatically set the location input field so it's sent to backend
            document.querySelector("input[name='location']").value = city;
        })
        .catch(err => {
            document.getElementById('city').innerText = "Error";
        });
});

// 🔁 Update map view when typing location
document.querySelector("input[name='location']").addEventListener("change", function () {
    const location = this.value.trim();
    if (!location) return;

    fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(location)}`)
        .then(res => res.json())
        .then(data => {
            if (data && data.length > 0) {
                const lat = parseFloat(data[0].lat).toFixed(4);
                const lon = parseFloat(data[0].lon).toFixed(4);
                const latlng = L.latLng(lat, lon);

                map.setView(latlng, 10);
                if (marker) map.removeLayer(marker);
                marker = L.marker(latlng).addTo(map);

                document.getElementById('lat').innerText = lat;
                document.getElementById('lon').innerText = lon;
                document.getElementById('city').innerText = location;
            } else {
                alert("Location not found!");
            }
        })
        .catch(err => {
            alert("Error fetching location.");
            console.error(err);
        });
});
</script>
    </body>
</html>
